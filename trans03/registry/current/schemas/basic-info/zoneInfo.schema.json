
{
  "openapi": "3.0.3",
  "info": {
    "title": "CIC SSSS Zone Information APIs",
    "description": "Dedicated zone/floor/area queries within sites (extension of CMP-002). Granular location data for alert/measurement filtering. Supports floors, bays, restricted areas[file:1].",
    "version": "1.0.0",
    "contact": {
      "name": "CIC SSSS"
    }
  },
  "servers": [
    {
      "url": "https://api.example.com/v1"
    }
  ],
  "tags": [
    {
      "name": "Zone Info",
      "description": "Site zones/floors/sections (CMP-002 extension)[file:1]"
    }
  ],
  "paths": {
    "/zones": {
      "get": {
        "tags": ["Zone Info"],
        "summary": "Query all zones across sites (Vendor-hosted)",
        "description": "Global zone directory filtered by siteId/zoneType. Use for location-based alert filtering[file:1].",
        "operationId": "queryAllZones",
        "security": [{"bearerAuth": []}],
        "parameters": [
          {
            "name": "siteId",
            "in": "query",
            "schema": {"type": "string"}
          },
          {
            "name": "zoneType",
            "in": "query",
            "schema": {
              "type": "string",
              "enum": ["floor", "area", "bay", "section", "restricted", "loading"]
            }
          },
          {
            "$ref": "#/components/parameters/zoneId"
          },
          {
            "name": "enableStatus",
            "in": "query",
            "schema": {"type": "boolean"}
          },
          {
            "$ref": "#/components/parameters/pageNum"
          },
          {
            "$ref": "#/components/parameters/pageSize"
          }
        ],
        "responses": {
          "200": {
            "description": "Zone list",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ZoneListResponse"
                }
              }
            }
          }
        }
      }
    },
    "/zones/{zoneId}": {
      "get": {
        "tags": ["Zone Info"],
        "summary": "Query single zone details",
        "description": "Detailed zone info including boundaries, capacity, hazards[file:1].",
        "operationId": "getZoneDetails",
        "security": [{"bearerAuth": []}],
        "parameters": [
          {
            "name": "zoneId",
            "in": "path",
            "required": true,
            "schema": {"type": "string"}
          }
        ],
        "responses": {
          "200": {
            "description": "Zone details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ZoneDetailResponse"
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/NotFound"
          }
        }
      }
    },
    "/zones/{zoneId}/capacity": {
      "get": {
        "tags": ["Zone Info"],
        "summary": "Query zone capacity/occupancy",
        "description": "Current vs max personnel/equipment in zone (real-time)[file:1].",
        "operationId": "getZoneCapacity",
        "security": [{"bearerAuth": []}],
        "parameters": [
          {
            "name": "zoneId",
            "in": "path",
            "required": true,
            "schema": {"type": "string"}
          }
        ],
        "responses": {
          "200": {
            "description": "Capacity data",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ZoneCapacityResponse"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    },
    "schemas": {
      "ZoneInfo": {
        "type": "object",
        "required": ["zoneId", "siteId", "name", "zoneType"],
        "properties": {
          "zoneId": {
            "type": "string",
            "example": "floor-05"
          },
          "siteId": {
            "type": "string",
            "example": "AAYL001"
          },
          "name": {
            "type": "object",
            "properties": {
              "en-HK": {"type": "string", "example": "Level 5"},
              "zh-HK": {"type": "string", "example": "5樓"},
              "zh-CN": {"type": "string"}
            }
          },
          "zoneType": {
            "type": "string",
            "enum": ["floor", "area", "bay", "section", "restricted", "loading", "storage"],
            "example": "floor"
          },
          "parentZoneId": {
            "type": "string",
            "description": "For nested zones (bay → floor)"
          },
          "geometry": {
            "type": "object",
            "properties": {
              "type": {"type": "string", "enum": ["Polygon", "Point"]},
              "coordinates": {"type": "array", "items": {"type": "number"}}
            },
            "description": "GeoJSON geometry (WGS-84)[file:1]"
          },
          "capacity": {
            "type": "object",
            "properties": {
              "maxPersonnel": {"type": "integer", "example": 20},
              "maxEquipment": {"type": "integer", "example": 5}
            }
          },
          "hazards": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": ["fall", "confined", "chemical", "electrical", "crane"]
            }
          },
          "enableStatus": {
            "type": "boolean",
            "default": true
          },
          "zoneCode": {
            "type": "string",
            "example": "F05"
          }
        }
      },
      "ZoneListResponse": {
        "type": "object",
        "properties": {
          "code": {"type": "integer", "example": 10000},
          "msg": {"type": "string", "example": "success"},
          "data": {
            "type": "object",
            "properties": {
              "list": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/ZoneInfo"
                }
              },
              "totalCount": {"type": "integer"},
              "pageNum": {"type": "integer"},
              "pageSize": {"type": "integer"}
            }
          }
        }
      },
      "ZoneDetailResponse": {
        "type": "object",
        "properties": {
          "code": {"type": "integer", "example": 10000},
          "msg": {"type": "string"},
          "data": {
            "$ref": "#/components/schemas/ZoneInfo"
          }
        }
      },
      "ZoneCapacityResponse": {
        "type": "object",
        "properties": {
          "code": {"type": "integer", "example": 10000},
          "data": {
            "type": "object",
            "properties": {
              "zoneId": {"type": "string"},
              "currentPersonnel": {"type": "integer", "example": 12},
              "maxPersonnel": {"type": "integer", "example": 20},
              "occupancyRate": {"type": "number", "example": 0.6},
              "currentEquipment": {"type": "integer", "example": 3},
              "maxEquipment": {"type": "integer", "example": 5},
              "lastUpdated": {"type": "string", "format": "date-time"}
            }
          }
        }
      },
      "ApiResponse": {
        "type": "object",
        "properties": {
          "code": {"type": "integer"},
          "msg": {"type": "string"},
          "data": {"type": "null"}
        }
      }
    },
    "parameters": {
      "zoneId": {
        "name": "zoneId",
        "in": "query",
        "schema": {"type": "string"}
      },
      "pageNum": {
        "name": "pageNum",
        "in": "query",
        "schema": {"type": "integer", "default": 1, "minimum": 1}
      },
      "pageSize": {
        "name": "pageSize",
        "in": "query",
        "schema": {"type": "integer", "default": 20, "maximum": 100}
      }
    },
    "responses": {
      "NotFound": {
        "description": "Zone not found",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/ApiResponse"
            }
          }
        }
      }
    }
  }
}
